import{r as t,A as T,u as U,h as O,j as e,L as A,E as L,I as P,b as $,P as F,C as R,B as S,D as E}from"./index-meQg8-o7.js";const z=({setUserInfoSettingFormOpen:x})=>{const[b,r]=t.useState(!1),[m,f]=t.useState(""),[g,h]=t.useState({}),[G,j]=t.useState(!1),[I,c]=t.useState(!1),[N,d]=t.useState(""),[n,u]=t.useState(""),a=t.useContext(T),{sendRequest:i}=U(),C=()=>{x(!1)},M=t.useCallback(async({...o})=>{r(!0);try{await i({url:"/api/user/updateUserInfo",method:"PATCH",data:{dbObjectId:a.dbObjectId,...o},headers:{Authorization:`Bearer ${a.token}`}}),h(y=>({...y,...o}))}catch(y){O(y,f,j)}finally{r(!1)}},[a.token,a.dbObjectId,i]),k=t.useCallback(async()=>{r(!0);try{const o=await i({url:"/api/user/getUserInfo",method:"GET",headers:{Authorization:`Bearer ${a.token}`}});h(o.userInfo)}catch(o){O(o,f,j)}finally{r(!1)}},[a.token,i]);return t.useEffect(()=>{(async()=>{await k()})()},[k]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30 w-full h-full bg-black bg-opacity-30",onClick:()=>x(!1)}),b&&e.jsx(A,{}),e.jsx(L,{isOpen:G,onClose:()=>j(!1),content:m}),e.jsxs("div",{className:"absolute z-40 inline-block w-10/12 max-w-lg p-2 mx-auto overflow-y-auto transform -translate-x-1/2 -translate-y-1/2 bg-orange-100 rounded-md shadow-xl max-h-96 top-1/3 left-1/2 ",children:[e.jsx(P,{isOpen:I,onConfirm:M,setClose:()=>c(!1),title:`${N} 정보 변경`,content:"",inputTextType:N,placeHolder:n,hintList:[],setPasswordCheck:!0}),e.jsx($,{onClose:C}),e.jsxs("div",{className:"flex flex-col py-1",children:[e.jsx("h2",{className:"px-2 mb-4 text-lg font-bold text-center text-black",children:"- 계정 관리 -"}),e.jsxs("div",{className:"flex items-center justify-between p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("span",{className:"text-sm text-black",children:g.userName}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{c(!0),d("userName"),u("이름을 입력하세요")},children:"이름 변경하기"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("span",{className:"text-sm text-black",children:g.userEmail}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{c(!0),d("userEmail"),u("example@example.com")},children:"이메일 변경하기"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("span",{className:"text-sm text-black",children:"********"}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{c(!0),d("newPassword"),u("6자리 이상 비밀번호")},children:"비밀번호 변경하기"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("span",{className:"text-sm text-black",children:g.homeAddress}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{c(!0),d("homeAddress"),u("집 주소를 입력하세요")},children:"집주소 변경하기"})]}),e.jsxs("div",{className:"flex items-center justify-between p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("span",{className:"text-sm text-black",children:g.phoneNumber}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{c(!0),d("phoneNumber"),u("010-1234-5678")},children:"휴대폰 번호 변경하기"})]})]}),e.jsx("div",{className:"sticky bottom-0 text-lg font-bold text-center text-gray-500 transform -translate-x-1/2 left-1/2 animate-bounce",children:"↓"})]})]})};z.propTypes={setUserInfoSettingFormOpen:F.func.isRequired};const H=({setGroupManagingFormOpen:x})=>{const[b,r]=t.useState(!1),[m,f]=t.useState(!1),[g,h]=t.useState(!1),[G,j]=t.useState(""),[I,c]=t.useState({}),[N,d]=t.useState(!1),[n,u]=t.useState({type:"",placeholder:"",currentGroup:""}),a=t.useContext(T),{sendRequest:i}=U(),C=()=>x(!1),M=()=>{o("deleteGroup",""),h(!1)},k=t.useCallback(async()=>{r(!0);try{const s=await i({url:"/api/user/getUserInfo",method:"GET",headers:{Authorization:`Bearer ${a.token}`}});c(s.userInfo)}catch(s){O(s,j,f)}finally{r(!1)}},[a.token,i]),o=t.useCallback(async(s,l)=>{console.log(` actionType  :: ${s}`),console.log(` inputValue  :: ${l}`),console.log(` inputModalConfig  :: ${n}`),console.log(` inputModalConfig  :: ${JSON.stringify(n,null,2)}`),r(!0);try{let p,w,v;switch(s){case"createGroup":{p="/api/user/createGroup",w={dbObjectId:a.dbObjectId,createTargetGroupName:l},v="POST";break}case"updateGroup":{p="/api/user/updateGroup",w={dbObjectId:a.dbObjectId,currentGroup:n.currentGroup,updateTargetGroupName:l},v="PATCH";break}case"deleteGroup":{p="/api/user/deleteGroup",w={dbObjectId:a.dbObjectId,deleteTargetGroupName:n.currentGroup},v="DELETE";break}default:throw new Error(`Unexpected ActionType: ${s}`)}const B=await i({url:p,method:v,data:w,headers:{Authorization:`Bearer ${a.token}`}});c(D=>({...D,...B.userInfo}))}catch(p){O(p,j,f)}finally{r(!1)}},[a,n,i]);t.useEffect(()=>{k()},[k]);const y=(s,l,p="")=>{u({type:s,placeholder:l,currentGroup:p}),d(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-30 w-full h-full bg-black bg-opacity-30",onClick:C}),b&&e.jsx(A,{}),e.jsx(L,{isOpen:m,onClose:()=>f(!1),content:G}),e.jsx(R,{isOpen:g,onClose:()=>h(!1),onConfirm:M,title:"작업 확인",content:"정말 이 작업을 진행하시겠습니까?"}),e.jsxs("div",{className:"absolute z-40 inline-block w-10/12 max-w-lg p-2 mx-auto overflow-y-auto transform -translate-x-1/2 -translate-y-1/2 bg-orange-100 rounded-md shadow-xl max-h-96 top-1/3 left-1/2 ",children:[e.jsx($,{onClose:C}),e.jsx(P,{isOpen:N,onConfirm:s=>o(n.type,s),setClose:()=>d(!1),title:n.type,inputTextType:n.type,placeHolder:n.placeholder,hintList:["안방","거실","아기방"],setPasswordCheck:!1}),e.jsxs("div",{className:"flex flex-col py-1",children:[e.jsx("h2",{className:"px-2 mb-4 text-lg font-bold text-center text-black",children:"- 그룹 관리 -"}),e.jsxs("div",{className:"flex items-center p-1 mb-4 bg-white border border-gray-800",children:[e.jsx("div",{className:"flex flex-col",children:(I.deviceGroupList||[]).map((s,l)=>e.jsxs("span",{className:"flex-wrap text-sm text-black",children:[l+1," : ",s]},l))}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>y("createGroup","ex) 안방, 거실, 아기방 ...","create"),children:"새로운 그룹 추가"})})]}),(I.deviceGroupList||[]).map((s,l)=>e.jsxs("div",{className:"flex items-center p-1 mb-2 bg-white border border-gray-800",children:[e.jsx("span",{className:"flex-wrap text-sm text-black",children:s}),e.jsxs("div",{className:"ml-auto",children:[e.jsx("button",{className:"text-black bg-orange-300 text- hover:bg-orange-400",onClick:()=>y("updateGroup","변경",s),children:"변경"}),e.jsx("button",{className:"text-black bg-orange-300 hover:bg-orange-400",onClick:()=>{h(!0),u({type:"deleteGroup",placeholder:"삭제",currentGroup:s})},children:"삭제"})]})]},l))]}),e.jsx("div",{className:"sticky bottom-0 text-lg font-bold text-center text-gray-500 transform -translate-x-1/2 left-1/2 animate-bounce",children:"↓"})]})]})};H.propTypes={setGroupManagingFormOpen:F.func.isRequired};function J(){const[x,b]=t.useState(!1),[r,m]=t.useState(!1);return e.jsxs("div",{className:"flex flex-col px-2 py-8 space-y-3",children:[x&&e.jsx(z,{setUserInfoSettingFormOpen:b}),r&&e.jsx(H,{setGroupManagingFormOpen:m}),e.jsx(S,{icon:E,content:"계정 정보 변경",onClick:()=>b(!0)}),e.jsx(S,{icon:E,content:"그룹 정보 관리",onClick:()=>m(!0)})]})}export{J as default};
