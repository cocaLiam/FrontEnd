import{r as t,A as g,u as C,j as o,L as E,E as I,B as j,D as y,a as D,c as A,h as l}from"./index-meQg8-o7.js";function m(){const[d,n]=t.useState(!1),[u,a]=t.useState(!1),[f,c]=t.useState(""),i=t.useContext(g),{sendRequest:h}=C(),x=async(e,s,v)=>{try{n(!0);const r=await h({url:`/api/device/${i.dbObjectId}/deviceCreate`,method:"POST",headers:{Authorization:`Bearer ${i.token}`},data:{macAddress:e,deviceType:s,battery:v}});console.log("기기 생성 성공:",r)}catch(r){l(r,c,a)}finally{n(!1)}},p=async e=>{try{const s=A(e);if(console.log("resConnect 받은 DATA:",JSON.stringify(e,null,2)),console.log("validation:",s.isValid),!s.isValid)throw{status:133};return console.log("유효한 데이터:",e),await x(e.macAddress,e.deviceType,"50"),!0}catch(s){l(s,c,a)}finally{n(!1)}};return t.useEffect(()=>{window.resConnect=p},[]),o.jsxs("div",{className:"flex flex-col",children:[d&&o.jsx(E,{}),o.jsx(I,{isOpen:u,onClose:()=>a(!1),content:f}),o.jsx("div",{children:"Device 추가 메뉴얼 : 화면에 보이는 IoT 기기를 체크 한 후, Connect 버튼을 눌러주세요"}),o.jsx(j,{icon:y,content:"IoT 기기 추가하기",onClick:()=>{D.reqConnect()}})]})}export{m as default};
